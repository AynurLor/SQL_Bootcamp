# День 04


## Упражнение 00

Создайте 2 представления базы данных (с атрибутами, аналогичными исходной таблице) на основе простой фильтрации пола людей. Задайте соответствующие имена для представлений базы данных: `v_persons_female` и `v_persons_male`.


## Упражнение 01 

Пожалуйста, используйте 2 представления базы данных из упражнения #00 и напишите SQL для получения женских и мужских имен в одном списке. Пожалуйста, установите порядок по имени человека.


## Упражнение 02

Пожалуйста, создайте представление базы данных (с именем `v_generated_dates`), которое должно "хранить" сгенерированные даты с 1 по 31 января 2022 года в типе DATE. Не забудьте про порядок для столбца generated_date.  


## Упражнение 03

Напишите SQL-запрос, который возвращает недостающие дни для визитов людей в январе 2022 года. Используйте для этого представление `v_generated_dates` и отсортируйте результат по столбцу missing_date.



## Упражнение 04

Напишите, пожалуйста, SQL-запрос, удовлетворяющий формуле `(R - S)∪(S - R)`.
Где R - таблица `person_visits` с фильтром по 2 января 2022 года, S - также таблица `person_visits`, но с другим фильтром по 6 января 2022 года. Пожалуйста, сделайте вычисления с наборами по столбцу `person_id` и этот столбец будет один в результате. Результат отсортируйте по колонке `person_id` и ваш окончательный SQL представьте в виде `v_symmetric_union` (*) базы данных.

(*) честно говоря, определение "симметричное объединение" не существует в теории множеств. Это авторская интерпретация, основная идея основана на существующем правиле симметричной разности. 


## Упражнение 05

Пожалуйста, создайте представление базы данных `v_price_with_discount`, которое возвращает заказы человека с именами людей, названиями пицц, реальной ценой и вычисляемой колонкой `discount_price` (с примененной 10% скидкой и удовлетворяющей формуле `price - price*0.1`). Результат отсортируйте по имени человека и названию пиццы и округлите столбец `discount_price` до целочисленного типа. 


## Упражнение 06

Пожалуйста, создайте материализованное представление `mv_dmitriy_visits_and_eats` (с включенными данными) на основе SQL-запроса, который находит название пиццерии, которую Дмитрий посетил 8 января 2022 года и смог съесть пиццу менее чем за 800 рублей (этот SQL вы можете узнать на Дне #02 Упражнение #07). 

Чтобы проверить себя, вы можете написать SQL к материализованному представлению `mv_dmitriy_visits_and_eats` и сравнить результаты с вашим предыдущим запросом.


## Упражнение 07

Давайте обновим данные в нашем материализованном представлении `mv_dmitriy_visits_and_eats` из упражнения #06. Перед этим действием, пожалуйста, создайте еще один визит Дмитрия, удовлетворяющий пункту SQL материализованного представления, за исключением пиццерии, которую мы можем видеть в результате упражнения #06.
После добавления нового визита обновите состояние данных для `mv_dmitriy_visits_and_eats`.



## Упражнение 08

Удалить все материализованные представления
