# День 07

## Упражнение 00

Давайте сделаем простую агрегацию, пожалуйста, напишите SQL-запрос, который возвращает идентификаторы людей и соответствующее количество посещений в любой пиццерии с сортировкой по количеству посещений по убыванию и сортировкой по `person_id` по возрастанию


## Упражнение 01

Пожалуйста, измените SQL оператор из упражнения 00 и верните имя человека (не идентификатор). Дополнительное условие - нам нужно увидеть только топ-4 персон с максимальным количеством посещений в любых пиццериях и отсортированных по имени персоны. 


## Упражнение 02

Напишите, пожалуйста, SQL-запрос для просмотра 3 любимых ресторанов по посещениям и по заказам в одном списке (пожалуйста, добавьте колонку action_type со значениями 'order' или 'visit', это зависит от данных из соответствующей таблицы). Пожалуйста, посмотрите на пример данных ниже. Результат должен быть отсортирован по столбцу action_type по возрастанию и по столбцу count по убыванию.



## Упражнение 03

Напишите SQL-запрос, чтобы увидеть, что рестораны группируются по посещениям и заказам и соединяются друг с другом с помощью названия ресторана.  
Вы можете использовать внутренний SQL из упражнения 02 (рестораны по посещениям и по заказам) без ограничений на количество строк.

Кроме того, добавьте следующие правила.
- подсчитать сумму заказов и посещений для соответствующей пиццерии (учтите, что не все ключи пиццерий представлены в обеих таблицах).
- сортировать результаты по столбцу `total_count` по убыванию и по `name` по возрастанию.


## Упражнение 04

Напишите SQL-запрос, который возвращает имя человека и соответствующее количество посещений любой пиццерии, если человек посетил ее более 3 раз (> 3).


## Упражнение 05

Напишите, пожалуйста, простой SQL-запрос, который возвращает список уникальных имен людей, сделавших заказы в любой пиццерии. Результат должен быть отсортирован по имени человека. 


## Упражнение 06

Напишите, пожалуйста, SQL-запрос, который возвращает количество заказов, среднюю цену, максимальную и минимальную цены на проданную пиццу по соответствующему ресторану-пиццерии. Результат должен быть отсортирован по названию пиццерии. Пожалуйста, посмотрите на образец данных ниже. 
Округлите среднюю цену до 2 плавающих чисел.


## Упражнение 07

Напишите SQL-запрос, который возвращает общий средний рейтинг (имя выходного атрибута global_rating) для всех ресторанов. Округлите средний рейтинг до 4 плавающих чисел.


## Упражнение 08

Мы знаем о персональных адресах из наших данных. Представим, что конкретный человек посещает пиццерии только в своем городе. Пожалуйста, напишите SQL-запрос, который возвращает адрес, название пиццерии и количество заказов человека. Результат должен быть отсортирован по адресу, а затем по названию ресторана.


## Упражнение 09

Напишите, пожалуйста, SQL-запрос, который возвращает агрегированную информацию по адресу человека, результат "Максимальный возраст - (Минимальный возраст / Максимальный возраст)", который представлен в виде столбца формулы, далее средний возраст по адресу и результат сравнения между столбцами формулы и среднего (другими словами, если формула больше среднего, то True, иначе False).

Результат должен быть отсортирован по столбцу адреса.
